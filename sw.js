const CACHE="PWA_CACHE_V1",filesToCache=["/","./sw.js","./manifest.json","./icons/logo.png","./icons/splash.png","./fonts/Poppins-Medium.woff","./fonts/Poppins-SemiBold.woff"];self.addEventListener("install",e=>{e.waitUntil(caches.open(CACHE).then(e=>(console.log("Opened cache"),e.addAll(filesToCache))).catch(e=>{console.error("Cache addAll error:",e)}))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(e!==CACHE)return console.log("Deleting old cache:",e),caches.delete(e)}))).then(()=>(console.log("New service worker activated"),self.clients.claim())))}),self.addEventListener("fetch",s=>{"navigate"===s.request.mode?s.respondWith(fetch(s.request).catch(()=>(console.log("Navigation fetch failed, falling back to cache"),caches.match(s.request)))):s.respondWith(caches.match(s.request).then(e=>e?(console.log("Found in cache:",s.request.url),e):(console.log("Not found in cache, fetching:",s.request.url),fetch(s.request).then(e=>{if(!e||200!==e.status||"basic"!==e.type)return e;var t=e.clone();return caches.open(CACHE).then(e=>{e.put(s.request,t),console.log("Cached new resource:",s.request.url)}),e}))).catch(e=>{console.error("Fetch error:",e)}))}),self.addEventListener("message",e=>{e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting()});